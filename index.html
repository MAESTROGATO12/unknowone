<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Proyecto Narrativo</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family: "Segoe UI", system-ui, sans-serif;
  background:#0b0b0f;
  color:#e5e7eb;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.game{
  width:900px;
  max-width:90%;
  background:#111118;
  border-radius:20px;
  padding:40px;
  box-shadow:0 0 60px rgba(0,0,0,.6);
}

.title{
  font-size:1.8rem;
  margin-bottom:20px;
  opacity:.9;
}

.text{
  font-size:1.1rem;
  line-height:1.7;
  margin-bottom:30px;
  min-height:140px;
}

.choices{
  display:flex;
  flex-direction:column;
  gap:14px;
}

button{
  background:#1f2937;
  border:none;
  padding:16px;
  border-radius:12px;
  color:#fff;
  font-size:1rem;
  cursor:pointer;
  transition:.2s;
}

button:hover{
  background:#374151;
}

.footer{
  margin-top:25px;
  font-size:.75rem;
  color:#6b7280;
  text-align:right;
}
</style>
</head>

<body>

<div class="game">
  <div class="title" id="title"></div>
  <div class="text" id="text"></div>
  <div class="choices" id="choices"></div>
  <div class="footer">Guardado automático</div>
</div>

<script>
// =================== ESTADO DEL JUEGO ===================

let state = JSON.parse(localStorage.getItem("gameState")) || {
  scene: "inicio",
  rutina: 0,
  curiosidad: 0,
  culpa: 0
};

// =================== ESCENAS ===================

const scenes = {

  inicio: {
    title: "Un día normal",
    text: "Abres los ojos antes de que suene la alarma.\nNo recuerdas haber soñado, pero tienes una sensación rara.\nComo si algo hoy fuera distinto.",
    choices: [
      { text:"Levantarte", next:"levantarse", effect:()=>state.rutina++ },
      { text:"Quedarte unos minutos más", next:"cama", effect:()=>state.culpa++ }
    ]
  },

  levantarse: {
    title: "Rutina",
    text: "Te levantas casi en automático.\nEl suelo está frío.\nTodo parece exactamente igual que siempre.",
    choices: [
      { text:"Ir al baño", next:"bano" },
      { text:"Mirar el móvil", next:"movil", effect:()=>state.curiosidad++ }
    ]
  },

  cama: {
    title: "Cinco minutos más",
    text: "Cierras los ojos.\nSabes que no deberías.\nEl silencio es cómodo… demasiado.",
    choices: [
      { text:"Levantarte ahora", next:"levantarse" },
      { text:"Volver a dormir", next:"final_rutina", effect:()=>state.rutina++ }
    ]
  },

  movil: {
    title: "Notificación",
    text: "Hay un mensaje nuevo.\nNo tienes guardado este contacto.\nSolo dice:\n\n“¿Sigues fingiendo que no lo recuerdas?”",
    choices: [
      { text:"Abrir el mensaje", next:"mensaje", effect:()=>state.curiosidad+=2 },
      { text:"Ignorarlo", next:"bano", effect:()=>state.rutina++ }
    ]
  },

  mensaje: {
    title: "Lectura",
    text: "El mensaje desaparece al abrirlo.\nComo si nunca hubiera existido.\nEl móvil vuelve a estar vacío.",
    choices: [
      { text:"Pensar en ello", next:"final_curioso", effect:()=>state.culpa++ },
      { text:"Seguir con tu día", next:"bano" }
    ]
  },

  bano: {
    title: "Espejo",
    text: "Te miras al espejo.\nPor un segundo, juras que tu reflejo tarda en imitarte.",
    choices: [
      { text:"Apartar la mirada", next:"final_rutina" },
      { text:"Mirarte fijamente", next:"final_oculto", condition:()=>state.curiosidad>=2 }
    ]
  },

  // =================== FINALES ===================

  final_rutina: {
    title: "Rutina",
    text: "El día continúa.\nNada cambia.\nQuizá eso era lo que querías.\n\nFINAL: RUTINA",
    choices:[]
  },

  final_curioso: {
    title: "Duda",
    text: "El mensaje vuelve a tu cabeza una y otra vez.\nPuede que hoy no pase nada.\nPero ya no podrás ignorarlo.\n\nFINAL: DUDA",
    choices:[]
  },

  final_oculto: {
    title: "Reconocimiento",
    text: "El reflejo sonríe antes que tú.\nAhora recuerdas.\nSiempre lo supiste.\n\nFINAL OCULTO",
    choices:[]
  }

};

// =================== MOTOR ===================

function render(){
  const scene = scenes[state.scene];
  document.getElementById("title").textContent = scene.title;
  document.getElementById("text").textContent = scene.text;

  const choicesBox = document.getElementById("choices");
  choicesBox.innerHTML = "";

  scene.choices.forEach(choice=>{
    if(choice.condition && !choice.condition()) return;

    const btn = document.createElement("button");
    btn.textContent = choice.text;
    btn.onclick = ()=>{
      if(choice.effect) choice.effect();
      state.scene = choice.next;
      save();
      render();
    };
    choicesBox.appendChild(btn);
  });
}

function save(){
  localStorage.setItem("gameState", JSON.stringify(state));
}

render();
</script>

</body>
</html>
